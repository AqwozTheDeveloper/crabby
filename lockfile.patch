--- a/src/main.rs
+++ b/src/main.rs
@@ -367,10 +367,13 @@ async fn install_all_dependencies(registry: &str) -> Result<()> {
     let start = std::time::Instant::now();
     let mut installed = 0;
     let mut failed = Vec::new();
+    
+    // Load or create lock file
+    let mut lockfile = manifest::CrabbyLock::load()?;
     
     // Install packages with progress
     for (name, _version) in &all_deps {
-        print!("  {} Installing {}... ", style("â¬‡ï¸").dim(), style(name).cyan());
+        print!("  {} Installing {}... ", style("â¬‡ï¸").dim(), style(name).cyan());
         std::io::Write::flush(&mut std::io::stdout())?;
         
         match package_utils::install_package(name, registry) {
-            Ok((ver, _)) => {
-                println!("{} {}", style("âœ…").green(), style(ver).dim());
+            Ok((ver, tarball)) => {
+                println!("{} {}", style("âœ…").green(), style(&ver).dim());
+                
+                // Add to lock file
+                lockfile.add_package(name.clone(), ver, tarball);
                 installed += 1;
             }
@@ -384,6 +391,10 @@ async fn install_all_dependencies(registry: &str) -> Result<()> {
         }
     }
     
+    // Save lock file
+    lockfile.save()?;
+    println!("{} Lock file updated", style("ðŸ”’").dim());
+    
     let duration = start.elapsed();
     
     println!(
